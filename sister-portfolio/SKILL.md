---
name: sister-portfolio
description: 郑大姐实盘管家 - 自选股/持仓股管理、自动标签、实时推送。支持添加自选股和持仓股，自动打标签（概念/板块），记录买卖交易，实时推送股价和技术指标。

---

# 📈 郑大姐实盘管家

**触发关键词**: "实盘"、"自选股"、"持仓"、"添加股票"

---

## 功能概述

郑大姐实盘管家是一套完整的股票跟踪和管理系统，支持：

1. **自选股管理** - 添加/删除/查看关注股票
2. **持仓股管理** - 记录持仓、成本价、盈亏计算
3. **自动标签** - 基于股票名称自动识别概念板块
4. **交易记录** - 手动录入买入/卖出记录
5. **标签查询** - 按标签筛选股票
6. **实时推送** - 自动推送股价和技术指标（交易时段）

---

## 数据存储

所有数据保存在：
```
/root/.openclaw/workspace/memory/portfolio/
├── watchlist.json      # 自选股列表
├── positions.json      # 持仓股列表
├── tags.json          # 标签数据
└── trade_history.json # 交易记录
```

---

## 使用方式

### 方式1：命令行操作

```bash
# 进入技能目录
cd /root/.openclaw/workspace/skills/sister-portfolio

# 添加自选股
./portfolio.sh add-watch 300605 恒锋信息
./portfolio.sh add-watch 002594 比亚迪

# 添加持仓股（代码 名称 数量 成本价）
./portfolio.sh add-position 002594 比亚迪 1000 85.50

# 记录买入
./portfolio.sh buy 002594 500 90.20

# 记录卖出
./portfolio.sh sell 002594 300 95.00

# 列出自选股
./portfolio.sh list-watch

# 列出持仓
./portfolio.sh list-position

# 查看所有标签
./portfolio.sh list-tags

# 查看某个标签下的股票
./portfolio.sh show-tag 新能源

# 查询实时数据
./portfolio.sh query 002594

# 统计持仓盈亏
./portfolio.sh stats

# 检查是否交易时段
./portfolio.sh check-trading-hours

# 推送自选股报告
./portfolio.sh push-watch

# 推送持仓报告
./portfolio.sh push-position
```

### 方式2：通过郑大姐操作

直接对话：
- "郑大姐，添加自选股 300605 恒锋信息"
- "郑大姐，添加持仓 002594 比亚迪 1000股 成本85.50"
- "郑大姐，记录买入 002594 500股 90.20元"
- "郑大姐，查看我的自选股"
- "郑大姐，查看持仓盈亏"
- "郑大姐，显示所有标签"
- "郑大姐，查看新能源板块有哪些股票"

---

## 自动标签系统（精准版）

系统采用**双重标签机制**：

### 1. 精准标签库（优先匹配）

对于热门股票，系统内置了基于**企业核心业务**的精准标签：

| 股票 | 代码 | 精准标签 | 核心业务 |
|------|------|----------|----------|
| 比亚迪 | 002594 | 新能源汽车,动力电池,整车制造 | 新能源车全产业链 |
| 宁德时代 | 300750 | 锂电池,动力电池,储能 | 全球动力电池龙头 |
| 隆基绿能 | 601012 | 光伏组件,光伏设备,新能源 | 光伏组件龙头 |
| 特变电工 | 600089 | 输变电设备,光伏硅料,新能源 | 输变电+多晶硅双主业 |
| 科大讯飞 | 002230 | AI语音,人工智能,教育 | AI语音龙头 |
| 中芯国际 | 688981 | 晶圆代工,半导体,芯片制造 | 国产芯片制造 |
| 三花智控 | 002050 | 汽车热管理,人形机器人,特斯拉产业链 | 热管理+机器人执行器 |
| 恒瑞医药 | 600276 | 创新药,医药研发,医药龙头 | 创新药龙头 |
| 恒锋信息 | 300605 | 智慧城市,AI应用,软件服务 | 智慧城市+AI |
| ... | ... | ... | ... |

**精准标签特点**：
- ✅ 基于企业**实际主营业务**而非名称关键词
- ✅ 包含**产业链位置**（如：上游材料、中游制造、下游应用）
- ✅ 包含**核心概念**（如：特斯拉产业链、国产替代）
- ✅ 包含**行业地位**（如：龙头、细分领域第一）

### 2. 智能标签识别（备用匹配）

对于不在精准库中的股票，系统基于名称关键词智能识别：

| 标签 | 识别关键词 |
|------|-----------|
| AI科技 | 科技、信息、软件、网络、智能 |
| 新能源 | 新能、光伏、锂电、储能、氢能 |
| 医药医疗 | 医药、医疗、生物、药 |
| 大金融 | 银行、证券、保险、金融 |
| 军工 | 军工、航天、船舶、航空 |
| 大消费 | 消费、食品、饮料、家电、白酒 |
| 周期资源 | 资源、有色、稀土、煤炭、钢铁 |
| 地产基建 | 地产、建筑、建材、基建 |
| 新能源汽车 | 汽车、比亚迪、赛力斯 |
| 人形机器人 | 机器人、减速器、电机、自动化 |
| 半导体 | 芯片、半导体、集成电路、电子 |

### 3. 板块标签（自动识别）

| 板块 | 代码前缀 |
|------|----------|
| 沪主板 | 60开头 |
| 深主板 | 00开头 |
| 创业板 | 30开头 |
| 科创板 | 68开头 |
| 北交所 | 8/4开头 |

### 4. 标签管理命令

```bash
# 查看股票详细标签信息
./portfolio.sh show-stock-info 002594

# 手动添加/更新股票标签（仅当前会话有效）
./portfolio.sh add-stock-tag 300605 "恒锋信息" "智慧城市,AI应用,软件服务"

# 列出自选股及其标签
./portfolio.sh list-watch

# 按标签筛选股票
./portfolio.sh show-tag 新能源
./portfolio.sh show-tag 锂电池
./portfolio.sh show-tag 人形机器人
```

---

## 自动推送配置

### 设置定时推送（Cron任务）

**自选股推送（每30分钟）**：
```bash
# 编辑crontab
crontab -e

# 添加以下行（交易时段每30分钟推送）
*/30 9-11,13-15 * * 1-5 cd /root/.openclaw/workspace/skills/sister-portfolio && ./portfolio.sh push-watch >> /tmp/watch_push.log 2>&1
```

**持仓股推送（每15分钟）**：
```bash
# 编辑crontab
crontab -e

# 添加以下行（交易时段每15分钟推送）
*/15 9-11,13-15 * * 1-5 cd /root/.openclaw/workspace/skills/sister-portfolio && ./portfolio.sh push-position >> /tmp/position_push.log 2>&1
```

### 推送时间说明

- **自选股**：每30分钟推送一次
- **持仓股**：每15分钟推送一次
- **非交易时段**：自动跳过（周末、节假日、9:30前、11:30-13:00、15:00后）

---

## 命令速查表

| 命令 | 功能 | 示例 |
|------|------|------|
| `add-watch` | 添加自选股 | `add-watch 300605 恒锋信息` |
| `list-watch` | 列出自选股 | `list-watch` |
| `add-position` | 添加持仓 | `add-position 002594 比亚迪 1000 85.50` |
| `list-position` | 列出持仓 | `list-position` |
| `buy` | 记录买入 | `buy 002594 500 90.20` |
| `sell` | 记录卖出 | `sell 002594 300 95.00` |
| `list-tags` | 列出标签 | `list-tags` |
| `show-tag` | 显示标签股票 | `show-tag 新能源` |
| `show-stock-info` | 查看股票详细信息 | `show-stock-info 002594` |
| `add-stock-tag` | 手动添加标签 | `add-stock-tag 300605 "恒锋信息" "智慧城市,AI应用"` |
| `refresh-tags` | 刷新所有股票标签 | `refresh-tags` |
| `query` | 查询实时数据 | `query 002594` |
| `stats` | 统计盈亏 | `stats` |
| `push-watch` | 推送自选报告 | `push-watch` |
| `push-position` | 推送持仓报告 | `push-position` |

---

## 推送报告格式

### 自选股推送报告（每30分钟）

```
📊 郑大姐自选股监控报告 (10:00)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
监控 5 只自选股

• 恒锋信息 (300605) - AI科技, 创业板
• 比亚迪 (002594) - 新能源, 新能源汽车
• 格林美 (002340) - 新能源, 周期资源
• 浙江东方 (600120) - 大金融, 沪主板
• 豆神教育 (300010) - 教育, 创业板

【操作建议】
请查询实时数据获取技术分析...
```

### 持仓股推送报告（每15分钟）

```
💼 郑大姐持仓监控报告 (10:15)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
共 3 只持仓，总成本 ¥125,000.00

• 比亚迪 (002594): 1000股 @ ¥85.50
• 格林美 (002340): 5000股 @ ¥7.20
• 浙江东方 (600120): 3000股 @ ¥6.50

【盈亏监控】
当前盈亏: +5.2% (¥6,500)
最大浮盈: 比亚迪 +8.5%
最大浮亏: 格林美 -3.2%
```

---

## 注意事项

1. **数据持久化** - 所有数据保存在JSON文件中，重启不会丢失
2. **自动标签** - 基于股票名称智能识别，可能不完全准确，可手动调整
3. **交易时间** - 推送功能只在A股交易时段生效（周一至周五 9:30-11:30, 13:00-15:00）
4. **盈亏计算** - 需要实时股价数据配合查询
5. **备份建议** - 定期备份 `/root/.openclaw/workspace/memory/portfolio/` 目录

---

## 郑大姐唠叨

"炒股不记帐，等于瞎折腾！每只票什么成本、什么逻辑、什么目标位，都得给我记着！"

"自选股是你的观察哨，持仓股是你的阵地战。观察哨每半小时巡逻一次，阵地每15分钟报数一次，这叫什么？这叫**纪律**！"

"别嫌麻烦，好记性不如烂笔头。等你持仓多了，不看记录都不知道自己买了啥。"

"记住大姐的话：**会买的是徒弟，会卖的是师傅，会记账的才是祖师爷**！"

---

## 未来扩展（Roadmap）

- [ ] Web界面管理
- [ ] 自动获取实时股价计算盈亏
- [ ] 预警功能（价格触及止损/止盈位自动提醒）
- [ ] 图表展示（持仓分布、盈亏曲线）
- [ ] 导入导出功能（Excel/CSV）
- [ ] 多账户支持
